if(!window.global){window.global=window}(function(f){var u=undefined;var g=(function(){var F=false;var z=false;var A="Msxml2.XMLHTTP";try{new XDomainRequest();F=true;z=true}catch(o){try{new ActiveXObject(A);F=true}catch(E){}}var D=(function(){var G;if(F){try{G=new XMLHttpRequest();G=function(){return new XMLHttpRequest()}}catch(H){}if(G==u){try{new ActiveXObject(A+".6.0");G=function(){return new ActiveXObject(A+".6.0")}}catch(H){}}if(G==u){try{new ActiveXObject(A+".3.0");G=function(){return new ActiveXObject(A+".3.0")}}catch(H){}}if(G==u){try{new ActiveXObject(A);G=function(){return new ActiveXObject(A)}}catch(H){}}if(G==u){G=function(){return new ActiveXObject("Microsoft.XMLHTTP")}}}if(G==u){G=function(){return new XMLHttpRequest()}}if(z){return function(I){if(I==1){var J=new XDomainRequest();J.ie=0;return J}return G()}}return G})();var C=function(H,G,J){if(!J["Content-Type"]){if(H=="POST"){G.setRequestHeader("Content-Type","application/x-www-form-urlencoded")}else{if(H=="JSON"){G.setRequestHeader("Content-Type","application/json")}}}if(J){for(var I in J){if(I!="Content-Length"){G.setRequestHeader(I,J[I])}}}};var B=function(G){return G=="JSON"?"POST":G};return function(G,I,M,K,Q,O,P){G=(G+"").toUpperCase();if(O!=true){I+=((I.indexOf("?")==-1)?"?":"&")+(new Date().getTime())}var N="";if(M){if(typeof(M)=="string"||M instanceof Blob||M instanceof File||M instanceof Uint8Array||M instanceof ArrayBuffer){N=M}else{var J=0;for(var L in M){if(J!=0){N+="&"}N+=L+"="+encodeURIComponent(M[L]);J++}}}if(G=="GET"){I+=N;N=null}if(K==u){var S=D();S.open(B(G),I,false);C(G,S,P);S.send(N);var H=S.status;if(H==0){H=500}var R=S.responseText;S.abort();if(H<300){return R}throw new Error("response status:"+H+" error")}else{var S=D((/^https?:\/\//i.test(I))?1:0);if(S.ie==0){S.onprogress=function(){};S.onload=function(){try{var T=S.status;if(!T||T==0){T=500}if(T<300){K(T,S.responseText)}else{if(Q!=u){Q(T,S.responseText)}else{K(T,S.responseText)}}}finally{S.abort();S=null;K=null;Q=null}};if(Q!=u){S.onerror=function(){var T=S.status;if(!T||T==0){T=500}Q(T,S.responseText);S.abort();S=null;K=null;Q=null}}else{S.onerror=function(){var T=S.status;if(!T||T==0){T=500}K(T,S.responseText);S.abort();S=null;K=null;Q=null}}S.open(B(G),I)}else{S.open(B(G),I,true);if(F){S.onreadystatechange=function(){if(S.readyState==4){try{var T=S.status;if(!T||T==0){T=500}if(T<300){K(T,S.responseText)}else{if(Q!=u){Q(T,S.responseText)}else{K(T,S.responseText)}}}finally{S.abort();S=null;K=null;Q=null}}}}else{S.onload=function(){if(S.readyState==4){try{var T=S.status;if(!T||T==0){T=500}if(T<300){K(T,S.responseText)}else{if(Q!=u){Q(T,S.responseText)}else{K(T,S.responseText)}}}finally{S.abort();S=null;K=null;Q=null}}};if(Q!=u){S.onerror=function(){var T=S.status;if(!status||status==0){status=500}Q(status,S.responseText);S.abort();S=null;K=null;Q=null}}else{S.onerror=function(){var T=S.status;if(!T||T==0){T=500}K(T,S.responseText);S.abort();S=null;K=null;Q=null}}}}C(G,S,P);S.send(N)}}})();var y=function(C){var B;var z=0;var o=C.length;for(var A=0;A<o;A++){if((B=C.charCodeAt(A))<128){z++}else{if((B>127)&&(B<2048)){z+=2}else{z+=3}}}return z};var m=function(o){var z=o.lastIndexOf(".");if(z==-1){return"application/octet-stream"}var A=o.substring(z+1);switch(A){case"htm":case"html":return"text/html; charset=utf-8;";case"xhtml":case"xht":return"application/xhtml+xml; charset=utf-8;";case"js":return"text/javascript; charset=utf-8;";case"css":return"text/css; charset=utf-8;";case"rtf":return"text/rtf";case"tsv":return"text/tab-separated-values";case"gif":return"image/gif";case"jpg":case"jpeg":return"image/jpeg";case"png":return"image/png";case"svg":return"image/svg+xml";case"rss":case"xml":case"xsl":return"application/xml";case"pdf":return"application/pdf";case"doc":return"application/msword";case"xls":return"application/vnd.ms-excel";case"ppt":return"application/vnd.ms-powerpoint";case"docx":return"application/vnd.openxmlformats-officedocument.wordprocessingml.document docx";case"xlsx":return"application/vnd.openxmlformats-officedocument.spreadsheetml.sheet xlsx";case"pptx":return"application/vnd.openxmlformats-officedocument.presentationml.presentation pptx";case"dtd":return"application/xml-dtd";case"sh":return"application/x-sh";case"tar":return"application/x-tar";case"zip":return"application/zip";case"jar":return"application/java-archive";case"swf":return"application/x-shockwave-flash";case"mpga":case"mp2":case"mp3":return"audio/mpeg";case"wma":return"audio/x-ms-wma";case"wav":return"audio/x-wav";case"3gp":return"video/3gpp";case"3g2":return"video/3gpp2";case"mpeg":case"mpg":case"mpe":return"video/mpeg";case"qt":case"mov":return"video/quicktime";case"mxu":case"m4u":return"video/vnd.mpegurl";case"asf":case"asx":return"video/x-ms-asf";case"avi":return"video/x-msvideo";case"wmv":return"video/x-ms-wmv";case"flv":return"video/x-flv";case"ogg":return"application/ogg";case"mpg4":return"video/mp4";case"ico":return"image/x-icon"}return"application/octet-stream"};var b=location.protocol+"://"+location.host;var e=function(o,z){if(!o||o==""){return null}if(o.indexOf("http://")==0||o.indexOf("https://")==0){return o}if(o.indexOf("/")!=0){o="/"+o}if(!z||z==""){return b+o}};var p="X-Cbox-Write-Signatures";var l="X-Cbox-Execute-Type";var r="X-Cbox-Execute-Timeout";var v="create-folder";var a="remove-folder";var w="create-file";var x="get-file";var q="remove-file";var t="list";var c="is-file";var n="is-folder";var d="is-lock";var h=true;var k=function(o,A,C,E,B,D,G,F){o=e(o);var z=m(o);if(!B){B=h}C[l]=A;C[r]=(!D)?"":""+D;C["Content-Type"]=z;C["Content-Length"]=y(E);g("POST",o,E,G,F,B,C)};var j=function(B,C,F,E,z,D,o,A){B=e(B);if(B.lastIndexOf("/")==B.length-1){B+=E.name}else{B+="/"+E.name}if(!z){z=h}F[l]=C;F[r]=(!D)?"":""+D;F["Content-Type"]=E.type;F["Content-Length"]=E.size;g("POST",B,E,o,A,z,F)};var i=function(B,C,F,E,z,D,o,A){B=e(B);if(!z){z=h}F[l]=C;F[r]=(!D)?"":""+D;g("GET",B,E,o,A,z,F)};var s={};s.createFolder=function(B,z,A,o,C){i(B,v,{},null,o,C,z,A)};s.removeFolder=function(B,z,A,o,C){i(B,a,{},null,o,C,z,A)};s.updateFile=function(B,D,z,A,o,C){j(B,w,{},D,o,C,z,A)};s.updateData=function(B,D,z,A,o,C){k(B,w,{},D,o,C,z,A)};s.getFile=function(B,z,A,o,C){if(!o){o=false}i(B,x,{},null,o,C,z,A)};s.removeFile=function(B,z,A,o,C){i(B,q,{},null,o,C,z,A)};s.getList=function(B,z,A,o,C){i(B,t,{},null,o,C,z,A)};s.isFile=function(B,z,A,o,C){i(B,c,{},null,o,C,z,A)};s.isFolder=function(B,z,A,o,C){i(B,n,{},null,o,C,z,A)};s.isLock=function(B,z,A,o,C){i(B,d,{},null,o,C,z,A)};f.cbox=s})(global);