if(!window.global){window.global=window}(function(d){var r=undefined;var e=(function(){var C=false;var w=false;var x="Msxml2.XMLHTTP";try{new XDomainRequest();C=true;w=true}catch(o){try{new ActiveXObject(x);C=true}catch(B){}}var A=(function(){var D;if(C){try{D=new XMLHttpRequest();D=function(){return new XMLHttpRequest()}}catch(E){}if(D==r){try{new ActiveXObject(x+".6.0");D=function(){return new ActiveXObject(x+".6.0")}}catch(E){}}if(D==r){try{new ActiveXObject(x+".3.0");D=function(){return new ActiveXObject(x+".3.0")}}catch(E){}}if(D==r){try{new ActiveXObject(x);D=function(){return new ActiveXObject(x)}}catch(E){}}if(D==r){D=function(){return new ActiveXObject("Microsoft.XMLHTTP")}}}if(D==r){D=function(){return new XMLHttpRequest()}}if(w){return function(F){if(F==1){var G=new XDomainRequest();G.ie=0;return G}return D()}}return D})();var z=function(E,D,G){if(!G["Content-Type"]){if(E=="POST"){D.setRequestHeader("Content-Type","application/x-www-form-urlencoded")}else{if(E=="JSON"){D.setRequestHeader("Content-Type","application/json")}}}if(G){for(var F in G){if(F!="Content-Length"){D.setRequestHeader(F,G[F])}}}};var y=function(D){return D=="JSON"?"POST":D};return function(D,F,J,H,N,L,M){D=(D+"").toUpperCase();if(L!=true){F+=((F.indexOf("?")==-1)?"?":"&")+(new Date().getTime())}var K="";if(J){if(typeof(J)=="string"||J instanceof Blob||J instanceof File||J instanceof Uint8Array||J instanceof ArrayBuffer){K=J}else{var G=0;for(var I in J){if(G!=0){K+="&"}K+=I+"="+encodeURIComponent(J[I]);G++}}}if(D=="GET"){F+=K;K=null}if(H==r){var P=A();P.open(y(D),F,false);z(D,P,M);P.send(K);var E=P.status;if(E==0){E=500}var O=P.responseText;P.abort();if(E<300){return O}throw new Error("response status:"+E+" error")}else{var P=A((/^https?:\/\//i.test(F))?1:0);if(P.ie==0){P.onprogress=function(){};P.onload=function(){try{var Q=P.status;if(!Q||Q==0){Q=500}if(Q<300){H(Q,P.responseText)}else{if(N!=r){N(Q,P.responseText)}else{H(Q,P.responseText)}}}finally{P.abort();P=null;H=null;N=null}};if(N!=r){P.onerror=function(){var Q=P.status;if(!Q||Q==0){Q=500}N(Q,P.responseText);P.abort();P=null;H=null;N=null}}else{P.onerror=function(){var Q=P.status;if(!Q||Q==0){Q=500}H(Q,P.responseText);P.abort();P=null;H=null;N=null}}P.open(y(D),F)}else{P.open(y(D),F,true);if(C){P.onreadystatechange=function(){if(P.readyState==4){try{var Q=P.status;if(!Q||Q==0){Q=500}if(Q<300){H(Q,P.responseText)}else{if(N!=r){N(Q,P.responseText)}else{H(Q,P.responseText)}}}finally{P.abort();P=null;H=null;N=null}}}}else{P.onload=function(){if(P.readyState==4){try{var Q=P.status;if(!Q||Q==0){Q=500}if(Q<300){H(Q,P.responseText)}else{if(N!=r){N(Q,P.responseText)}else{H(Q,P.responseText)}}}finally{P.abort();P=null;H=null;N=null}}};if(N!=r){P.onerror=function(){var Q=P.status;if(!status||status==0){status=500}N(status,P.responseText);P.abort();P=null;H=null;N=null}}else{P.onerror=function(){var Q=P.status;if(!Q||Q==0){Q=500}H(Q,P.responseText);P.abort();P=null;H=null;N=null}}}}z(D,P,M);P.send(K)}}})();var v=function(z){var y;var w=0;var o=z.length;for(var x=0;x<o;x++){if((y=z.charCodeAt(x))<128){w++}else{if((y>127)&&(y<2048)){w+=2}else{w+=3}}}return w};var k=function(o){var w=o.lastIndexOf(".");if(w==-1){return"application/octet-stream"}var x=o.substring(w+1);switch(x){case"htm":case"html":return"text/html; charset=utf-8;";case"xhtml":case"xht":return"application/xhtml+xml; charset=utf-8;";case"js":return"text/javascript; charset=utf-8;";case"css":return"text/css; charset=utf-8;";case"rtf":return"text/rtf";case"tsv":return"text/tab-separated-values";case"gif":return"image/gif";case"jpg":case"jpeg":return"image/jpeg";case"png":return"image/png";case"svg":return"image/svg+xml";case"rss":case"xml":case"xsl":return"application/xml";case"pdf":return"application/pdf";case"doc":return"application/msword";case"xls":return"application/vnd.ms-excel";case"ppt":return"application/vnd.ms-powerpoint";case"docx":return"application/vnd.openxmlformats-officedocument.wordprocessingml.document docx";case"xlsx":return"application/vnd.openxmlformats-officedocument.spreadsheetml.sheet xlsx";case"pptx":return"application/vnd.openxmlformats-officedocument.presentationml.presentation pptx";case"dtd":return"application/xml-dtd";case"sh":return"application/x-sh";case"tar":return"application/x-tar";case"zip":return"application/zip";case"jar":return"application/java-archive";case"swf":return"application/x-shockwave-flash";case"mpga":case"mp2":case"mp3":return"audio/mpeg";case"wma":return"audio/x-ms-wma";case"wav":return"audio/x-wav";case"3gp":return"video/3gpp";case"3g2":return"video/3gpp2";case"mpeg":case"mpg":case"mpe":return"video/mpeg";case"qt":case"mov":return"video/quicktime";case"mxu":case"m4u":return"video/vnd.mpegurl";case"asf":case"asx":return"video/x-ms-asf";case"avi":return"video/x-msvideo";case"wmv":return"video/x-ms-wmv";case"flv":return"video/x-flv";case"ogg":return"application/ogg";case"mpg4":return"video/mp4";case"ico":return"image/x-icon"}return"application/octet-stream"};var m="X-Cbox-Write-Signatures";var j="X-Cbox-Execute-Type";var s="create-folder";var a="remove-folder";var t="create-file";var u="get-file";var n="remove-file";var q="list";var b="is-file";var l="is-folder";var c="is-lock";var f=true;var i=function(y,z,C,A,w,o,x){var B=k(y);if(!w){w=f}C[j]=z;C["Content-Type"]=B;C["Content-Length"]=v(A);e("POST",y,A,o,x,w,C)};var h=function(y,z,B,A,w,o,x){if(y.lastIndexOf("/")==y.length-1){y+=A.name}else{y+="/"+A.name}if(!w){w=f}B[j]=z;B["Content-Type"]=A.type;B["Content-Length"]=A.size;e("POST",y,A,o,x,w,B)};var g=function(y,z,B,A,w,o,x){if(!w){w=f}B[j]=z;e("GET",y,A,o,x,w,B)};var p={};p.createFolder=function(y,w,x,o){g(y,s,{},null,o,w,x)};p.removeFolder=function(y,w,x,o){g(y,a,{},null,o,w,x)};p.updateFile=function(y,z,w,x,o){h(y,t,{},z,o,w,x)};p.updateData=function(y,z,w,x,o){i(y,t,{},z,o,w,x)};p.getFile=function(y,w,x,o){if(!o){o=false}g(y,u,{},null,o,w,x)};p.removeFile=function(y,w,x,o){g(y,n,{},null,o,w,x)};p.getList=function(y,w,x,o){g(y,q,{},null,o,w,x)};p.isFile=function(y,w,x,o){g(y,b,{},null,o,w,x)};p.isFolder=function(y,w,x,o){g(y,l,{},null,o,w,x)};p.isLock=function(y,w,x,o){g(y,c,{},null,o,w,x)};d.cbox=p})(global);