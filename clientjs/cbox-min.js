if(!window.global){window.global=window}(function(f){var t=undefined;var g=(function(){var E=false;var y=false;var z="Msxml2.XMLHTTP";try{new XDomainRequest();E=true;y=true}catch(o){try{new ActiveXObject(z);E=true}catch(D){}}var C=(function(){var F;if(E){try{F=new XMLHttpRequest();F=function(){return new XMLHttpRequest()}}catch(G){}if(F==t){try{new ActiveXObject(z+".6.0");F=function(){return new ActiveXObject(z+".6.0")}}catch(G){}}if(F==t){try{new ActiveXObject(z+".3.0");F=function(){return new ActiveXObject(z+".3.0")}}catch(G){}}if(F==t){try{new ActiveXObject(z);F=function(){return new ActiveXObject(z)}}catch(G){}}if(F==t){F=function(){return new ActiveXObject("Microsoft.XMLHTTP")}}}if(F==t){F=function(){return new XMLHttpRequest()}}if(y){return function(H){if(H==1){var I=new XDomainRequest();I.ie=0;return I}return F()}}return F})();var B=function(G,F,I){if(!I["Content-Type"]){if(G=="POST"){F.setRequestHeader("Content-Type","application/x-www-form-urlencoded")}else{if(G=="JSON"){F.setRequestHeader("Content-Type","application/json")}}}if(I){for(var H in I){if(H!="Content-Length"){F.setRequestHeader(H,I[H])}}}};var A=function(F){return F=="JSON"?"POST":F};return function(F,H,L,J,P,N,O){F=(F+"").toUpperCase();if(N!=true){H+=((H.indexOf("?")==-1)?"?":"&")+(new Date().getTime())}var M="";if(L){if(typeof(L)=="string"||L instanceof Blob||L instanceof File||L instanceof Uint8Array||L instanceof ArrayBuffer){M=L}else{var I=0;for(var K in L){if(I!=0){M+="&"}M+=K+"="+encodeURIComponent(L[K]);I++}}}if(F=="GET"){H+=M;M=null}if(J==t){var R=C();R.open(A(F),H,false);B(F,R,O);R.send(M);var G=R.status;if(G==0){G=500}var Q=R.responseText;R.abort();if(G<300){return Q}throw new Error("response status:"+G+" error")}else{var R=C((/^https?:\/\//i.test(H))?1:0);if(R.ie==0){R.onprogress=function(){};R.onload=function(){try{var S=R.status;if(!S||S==0){S=500}if(S<300){J(S,R.responseText)}else{if(P!=t){P(S,R.responseText)}else{J(S,R.responseText)}}}finally{R.abort();R=null;J=null;P=null}};if(P!=t){R.onerror=function(){var S=R.status;if(!S||S==0){S=500}P(S,R.responseText);R.abort();R=null;J=null;P=null}}else{R.onerror=function(){var S=R.status;if(!S||S==0){S=500}J(S,R.responseText);R.abort();R=null;J=null;P=null}}R.open(A(F),H)}else{R.open(A(F),H,true);if(E){R.onreadystatechange=function(){if(R.readyState==4){try{var S=R.status;if(!S||S==0){S=500}if(S<300){J(S,R.responseText)}else{if(P!=t){P(S,R.responseText)}else{J(S,R.responseText)}}}finally{R.abort();R=null;J=null;P=null}}}}else{R.onload=function(){if(R.readyState==4){try{var S=R.status;if(!S||S==0){S=500}if(S<300){J(S,R.responseText)}else{if(P!=t){P(S,R.responseText)}else{J(S,R.responseText)}}}finally{R.abort();R=null;J=null;P=null}}};if(P!=t){R.onerror=function(){var S=R.status;if(!status||status==0){status=500}P(status,R.responseText);R.abort();R=null;J=null;P=null}}else{R.onerror=function(){var S=R.status;if(!S||S==0){S=500}J(S,R.responseText);R.abort();R=null;J=null;P=null}}}}B(F,R,O);R.send(M)}}})();var x=function(B){var A;var y=0;var o=B.length;for(var z=0;z<o;z++){if((A=B.charCodeAt(z))<128){y++}else{if((A>127)&&(A<2048)){y+=2}else{y+=3}}}return y};var m=function(o){var y=o.lastIndexOf(".");if(y==-1){return"application/octet-stream"}var z=o.substring(y+1);switch(z){case"htm":case"html":return"text/html; charset=utf-8;";case"xhtml":case"xht":return"application/xhtml+xml; charset=utf-8;";case"js":return"text/javascript; charset=utf-8;";case"css":return"text/css; charset=utf-8;";case"rtf":return"text/rtf";case"tsv":return"text/tab-separated-values";case"gif":return"image/gif";case"jpg":case"jpeg":return"image/jpeg";case"png":return"image/png";case"svg":return"image/svg+xml";case"rss":case"xml":case"xsl":return"application/xml";case"pdf":return"application/pdf";case"doc":return"application/msword";case"xls":return"application/vnd.ms-excel";case"ppt":return"application/vnd.ms-powerpoint";case"docx":return"application/vnd.openxmlformats-officedocument.wordprocessingml.document docx";case"xlsx":return"application/vnd.openxmlformats-officedocument.spreadsheetml.sheet xlsx";case"pptx":return"application/vnd.openxmlformats-officedocument.presentationml.presentation pptx";case"dtd":return"application/xml-dtd";case"sh":return"application/x-sh";case"tar":return"application/x-tar";case"zip":return"application/zip";case"jar":return"application/java-archive";case"swf":return"application/x-shockwave-flash";case"mpga":case"mp2":case"mp3":return"audio/mpeg";case"wma":return"audio/x-ms-wma";case"wav":return"audio/x-wav";case"3gp":return"video/3gpp";case"3g2":return"video/3gpp2";case"mpeg":case"mpg":case"mpe":return"video/mpeg";case"qt":case"mov":return"video/quicktime";case"mxu":case"m4u":return"video/vnd.mpegurl";case"asf":case"asx":return"video/x-ms-asf";case"avi":return"video/x-msvideo";case"wmv":return"video/x-ms-wmv";case"flv":return"video/x-flv";case"ogg":return"application/ogg";case"mpg4":return"video/mp4";case"ico":return"image/x-icon"}return"application/octet-stream"};var b=location.protocol+"://"+location.host;var e=function(o,y){if(!o||o==""){return null}if(o.indexOf("http://")==0||o.indexOf("https://")==0){return o}if(o.indexOf("/")!=0){o="/"+o}if(!y||y==""){return b+o}};var p="X-Cbox-Write-Signatures";var l="X-Cbox-Execute-Type";var u="create-folder";var a="remove-folder";var v="create-file";var w="get-file";var q="remove-file";var s="list";var c="is-file";var n="is-folder";var d="is-lock";var h=true;var k=function(A,B,E,C,y,o,z){A=e(A);var D=m(A);if(!y){y=h}E[l]=B;E["Content-Type"]=D;E["Content-Length"]=x(C);g("POST",A,C,o,z,y,E)};var j=function(A,B,D,C,y,o,z){A=e(A);if(A.lastIndexOf("/")==A.length-1){A+=C.name}else{A+="/"+C.name}if(!y){y=h}D[l]=B;D["Content-Type"]=C.type;D["Content-Length"]=C.size;g("POST",A,C,o,z,y,D)};var i=function(A,B,D,C,y,o,z){A=e(A);if(!y){y=h}D[l]=B;g("GET",A,C,o,z,y,D)};var r={};r.createFolder=function(A,y,z,o){i(A,u,{},null,o,y,z)};r.removeFolder=function(A,y,z,o){i(A,a,{},null,o,y,z)};r.updateFile=function(A,B,y,z,o){j(A,v,{},B,o,y,z)};r.updateData=function(A,B,y,z,o){k(A,v,{},B,o,y,z)};r.getFile=function(A,y,z,o){if(!o){o=false}i(A,w,{},null,o,y,z)};r.removeFile=function(A,y,z,o){i(A,q,{},null,o,y,z)};r.getList=function(A,y,z,o){i(A,s,{},null,o,y,z)};r.isFile=function(A,y,z,o){i(A,c,{},null,o,y,z)};r.isFolder=function(A,y,z,o){i(A,n,{},null,o,y,z)};r.isLock=function(A,y,z,o){i(A,d,{},null,o,y,z)};f.cbox=r})(global);