if(!window.global){window.global=window}(function(f){var v=undefined;var g=(function(){var G=false;var A=false;var B="Msxml2.XMLHTTP";try{new XDomainRequest();G=true;A=true}catch(o){try{new ActiveXObject(B);G=true}catch(F){}}var E=(function(){var H;if(G){try{H=new XMLHttpRequest();H=function(){return new XMLHttpRequest()}}catch(I){}if(H==v){try{new ActiveXObject(B+".6.0");H=function(){return new ActiveXObject(B+".6.0")}}catch(I){}}if(H==v){try{new ActiveXObject(B+".3.0");H=function(){return new ActiveXObject(B+".3.0")}}catch(I){}}if(H==v){try{new ActiveXObject(B);H=function(){return new ActiveXObject(B)}}catch(I){}}if(H==v){H=function(){return new ActiveXObject("Microsoft.XMLHTTP")}}}if(H==v){H=function(){return new XMLHttpRequest()}}if(A){return function(J){if(J==1){var K=new XDomainRequest();K.ie=0;return K}return H()}}return H})();var D=function(I,H,K){if(!K["Content-Type"]){if(I=="POST"){H.setRequestHeader("Content-Type","application/x-www-form-urlencoded")}else{if(I=="JSON"){H.setRequestHeader("Content-Type","application/json")}}}if(K){for(var J in K){if(J!="Content-Length"){H.setRequestHeader(J,K[J])}}}};var C=function(H){return H=="JSON"?"POST":H};return function(H,J,N,L,R,P,Q){H=(H+"").toUpperCase();if(P!=true){J+=((J.indexOf("?")==-1)?"?":"&")+(new Date().getTime())}var O="";if(N){if(typeof(N)=="string"||N instanceof Blob||N instanceof File||N instanceof Uint8Array||N instanceof ArrayBuffer){O=N}else{var K=0;for(var M in N){if(K!=0){O+="&"}O+=M+"="+encodeURIComponent(N[M]);K++}}}if(H=="GET"){J+=O;O=null}if(L==v){var T=E();T.open(C(H),J,false);D(H,T,Q);T.send(O);var I=T.status;if(I==0){I=500}var S=T.responseText;T.abort();if(I<300){return S}throw new Error("response status:"+I+" error")}else{var T=E((/^https?:\/\//i.test(J))?1:0);if(T.ie==0){T.onprogress=function(){};T.onload=function(){try{var U=T.status;if(!U||U==0){U=500}if(U<300){L(U,T.responseText)}else{if(R!=v){R(U,T.responseText)}else{L(U,T.responseText)}}}finally{T.abort();T=null;L=null;R=null}};if(R!=v){T.onerror=function(){var U=T.status;if(!U||U==0){U=500}R(U,T.responseText);T.abort();T=null;L=null;R=null}}else{T.onerror=function(){var U=T.status;if(!U||U==0){U=500}L(U,T.responseText);T.abort();T=null;L=null;R=null}}T.open(C(H),J)}else{T.open(C(H),J,true);if(G){T.onreadystatechange=function(){if(T.readyState==4){try{var U=T.status;if(!U||U==0){U=500}if(U<300){L(U,T.responseText)}else{if(R!=v){R(U,T.responseText)}else{L(U,T.responseText)}}}finally{T.abort();T=null;L=null;R=null}}}}else{T.onload=function(){if(T.readyState==4){try{var U=T.status;if(!U||U==0){U=500}if(U<300){L(U,T.responseText)}else{if(R!=v){R(U,T.responseText)}else{L(U,T.responseText)}}}finally{T.abort();T=null;L=null;R=null}}};if(R!=v){T.onerror=function(){var U=T.status;if(!status||status==0){status=500}R(status,T.responseText);T.abort();T=null;L=null;R=null}}else{T.onerror=function(){var U=T.status;if(!U||U==0){U=500}L(U,T.responseText);T.abort();T=null;L=null;R=null}}}}D(H,T,Q);T.send(O)}}})();var z=function(D){var C;var A=0;var o=D.length;for(var B=0;B<o;B++){if((C=D.charCodeAt(B))<128){A++}else{if((C>127)&&(C<2048)){A+=2}else{A+=3}}}return A};var n=function(o){var A=o.lastIndexOf(".");if(A==-1){return"application/octet-stream"}var B=o.substring(A+1);switch(B){case"htm":case"html":return"text/html; charset=utf-8;";case"xhtml":case"xht":return"application/xhtml+xml; charset=utf-8;";case"js":return"text/javascript; charset=utf-8;";case"css":return"text/css; charset=utf-8;";case"rtf":return"text/rtf";case"tsv":return"text/tab-separated-values";case"gif":return"image/gif";case"jpg":case"jpeg":return"image/jpeg";case"png":return"image/png";case"svg":return"image/svg+xml";case"rss":case"xml":case"xsl":return"application/xml";case"pdf":return"application/pdf";case"doc":return"application/msword";case"xls":return"application/vnd.ms-excel";case"ppt":return"application/vnd.ms-powerpoint";case"docx":return"application/vnd.openxmlformats-officedocument.wordprocessingml.document docx";case"xlsx":return"application/vnd.openxmlformats-officedocument.spreadsheetml.sheet xlsx";case"pptx":return"application/vnd.openxmlformats-officedocument.presentationml.presentation pptx";case"dtd":return"application/xml-dtd";case"sh":return"application/x-sh";case"tar":return"application/x-tar";case"zip":return"application/zip";case"jar":return"application/java-archive";case"swf":return"application/x-shockwave-flash";case"mpga":case"mp2":case"mp3":return"audio/mpeg";case"wma":return"audio/x-ms-wma";case"wav":return"audio/x-wav";case"3gp":return"video/3gpp";case"3g2":return"video/3gpp2";case"mpeg":case"mpg":case"mpe":return"video/mpeg";case"qt":case"mov":return"video/quicktime";case"mxu":case"m4u":return"video/vnd.mpegurl";case"asf":case"asx":return"video/x-ms-asf";case"avi":return"video/x-msvideo";case"wmv":return"video/x-ms-wmv";case"flv":return"video/x-flv";case"ogg":return"application/ogg";case"mpg4":return"video/mp4";case"ico":return"image/x-icon"}return"application/octet-stream"};var b=location.protocol+"://"+location.host;var e=function(o,A){if(!o||o==""){return null}if(o.indexOf("http://")==0||o.indexOf("https://")==0){return o}if(o.indexOf("/")!=0){o="/"+o}if(!A||A==""){return b+o}};var q="X-Cbox-Write-Signatures";var l="X-Cbox-Execute-Type";var s="X-Cbox-Execute-Timeout";var w="create-folder";var a="remove-folder";var x="create-file";var y="get-file";var r="remove-file";var u="list";var c="is-file";var p="is-folder";var d="is-lock";var m="forced-lock";var h=true;var k=function(o,B,D,F,C,E,H,G){o=e(o);var A=n(o);if(!C){C=h}D[l]=B;D[s]=(!E)?"":""+E;D["Content-Type"]=A;D["Content-Length"]=z(F);g("POST",o,F,H,G,C,D)};var j=function(C,D,G,F,A,E,o,B){C=e(C);if(C.lastIndexOf("/")==C.length-1){C+=F.name}else{C+="/"+F.name}if(!A){A=h}G[l]=D;G[s]=(!E)?"":""+E;G["Content-Type"]=F.type;G["Content-Length"]=F.size;g("POST",C,F,o,B,A,G)};var i=function(C,D,G,F,A,E,o,B){C=e(C);if(!A){A=h}G[l]=D;G[s]=(!E)?"":""+E;g("GET",C,F,o,B,A,G)};var t={};t.createFolder=function(C,A,B,o,D){i(C,w,{},null,o,D,A,B)};t.removeFolder=function(C,A,B,o,D){i(C,a,{},null,o,D,A,B)};t.updateFile=function(C,E,A,B,o,D){j(C,x,{},E,o,D,A,B)};t.updateData=function(C,E,A,B,o,D){k(C,x,{},E,o,D,A,B)};t.getFile=function(C,A,B,o,D){if(!o){o=false}i(C,y,{},null,o,D,A,B)};t.removeFile=function(C,A,B,o,D){i(C,r,{},null,o,D,A,B)};t.getList=function(C,A,B,o,D){i(C,u,{},null,o,D,A,B)};t.isFile=function(C,A,B,o,D){i(C,c,{},null,o,D,A,B)};t.isFolder=function(C,A,B,o,D){i(C,p,{},null,o,D,A,B)};t.isLock=function(C,A,B,o,D){i(C,d,{},null,o,D,A,B)};t.forcedLock=function(C,A,B,o,D){i(C,m,{},null,o,D,A,B)};f.cbox=t})(global);